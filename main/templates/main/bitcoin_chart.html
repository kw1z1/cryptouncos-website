{% extends 'main/layout.html' %}
{% load static %}

{% block title %}–ì—Ä–∞—Ñ–∏–∫ BTC ‚Ä¢ CryptoUncos{% endblock %}

{% block content %}
<div class="container" style="max-width: 1200px; margin: 0 auto; padding: 2rem;">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div style="text-align: center; margin-bottom: 2rem;">
        <h1 style="color: #fff; font-size: 2.5rem;">BITCOIN LIVE CHART</h1>
        <p style="color: #ccc;">–ì—Ä–∞—Ñ–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å AI –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏</p>
    </div>

    <!-- –¶–µ–Ω–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ -->
    <div id="priceBox" style="background: #1a1a1a; border: 1px solid #e6007a; border-radius: 12px; padding: 1.5rem; text-align: center; margin-bottom: 2rem;">
        <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
            <span style="font-size: 2rem;">‚Çø</span>
            <span id="btcPrice" style="font-size: 2.5rem; font-weight: bold; color: #fff;">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            <span id="btcChange" style="padding: 0.5rem 1rem; border-radius: 20px; font-weight: bold;">--%</span>
        </div>
        <div style="display: flex; justify-content: center; gap: 2rem; color: #ccc; flex-wrap: wrap;">
            <div>–ú–∞–∫—Å 24—á: <span id="high24h">--</span></div>
            <div>–ú–∏–Ω 24—á: <span id="low24h">--</span></div>
            <div>–û–±—ä–µ–º: <span id="volume24h">--</span></div>
        </div>
    </div>

    <!-- –¢–∞–π–º—Ñ—Ä–µ–π–º—ã -->
    <div style="display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;">
        <button onclick="changeTimeframe('1h')" class="timeframe-btn active">1 —á–∞—Å</button>
        <button onclick="changeTimeframe('4h')" class="timeframe-btn">4 —á–∞—Å–∞</button>
        <button onclick="changeTimeframe('24h')" class="timeframe-btn">24 —á–∞—Å–∞</button>
        <button onclick="changeTimeframe('7d')" class="timeframe-btn">7 –¥–Ω–µ–π</button>
    </div>

    <!-- –ì—Ä–∞—Ñ–∏–∫ -->
    <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 1rem; margin-bottom: 2rem;">
        <canvas id="myChart" width="800" height="400"></canvas>
    </div>

    <!-- AI –ø—Ä–æ–≥–Ω–æ–∑ -->
    <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem;">
        <h3 style="color: #fff; text-align: center; margin-bottom: 1rem;">ü§ñ AI –ü–†–û–ì–ù–û–ó –¶–ï–ù–´</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <!-- –¢–µ–∫—É—â–∏–π –∞–Ω–∞–ª–∏–∑ -->
            <div>
                <h4 style="color: #e6007a; margin-bottom: 1rem;">üìä –ê–ù–ê–õ–ò–ó –†–´–ù–ö–ê</h4>
                <div style="color: #ccc; line-height: 1.6;">
                    <div>–¢—Ä–µ–Ω–¥: <span id="trend" style="font-weight: bold;">–ê–ù–ê–õ–ò–ó...</span></div>
                    <div>–°–∏–≥–Ω–∞–ª: <span id="signal" style="font-weight: bold;">--</span></div>
                    <div>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: <span id="confidence">--%</span></div>
                    <div>–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: <span id="volatility">--</span></div>
                </div>
            </div>
            
            <!-- –ü—Ä–æ–≥–Ω–æ–∑ -->
            <div>
                <h4 style="color: #e6007a; margin-bottom: 1rem;">‚è∞ –ü–†–û–ì–ù–û–ó –ù–ê <span id="timeframeLabel">1 –ß–ê–°</span></h4>
                <div style="color: #ccc; line-height: 1.6;">
                    <div>–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: <span id="currentPriceDisplay" style="font-weight: bold;">--</span></div>
                    <div>–ü—Ä–æ–≥–Ω–æ–∑ —Ü–µ–Ω—ã: <span id="predictedPrice" style="font-weight: bold; color: #00ff88;">--</span></div>
                    <div>–ò–∑–º–µ–Ω–µ–Ω–∏–µ: <span id="potentialChange" style="font-weight: bold;">--</span></div>
                    <div>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: <span id="recommendation" style="font-weight: bold;">--</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ -->
    <div style="display: flex; gap: 1rem; justify-content: center;">
        <button onclick="buyBTC()" style="padding: 1rem 2rem; background: #00ff88; border: none; border-radius: 8px; color: #000; font-weight: bold; cursor: pointer; font-size: 1.1rem;">
            üìà –ö–£–ü–ò–¢–¨ BTC
        </button>
        <button onclick="sellBTC()" style="padding: 1rem 2rem; background: #ff4444; border: none; border-radius: 8px; color: #fff; font-weight: bold; cursor: pointer; font-size: 1.1rem;">
            üìâ –ü–†–û–î–ê–¢–¨ BTC
        </button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let currentPrice = 0;
let priceHistory = [];
let chart;
let currentTimeframe = '1h';
let lastPrediction = null;

// –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
const style = document.createElement('style');
style.textContent = `
    .timeframe-btn {
        padding: 0.5rem 1rem;
        background: rgba(255,255,255,0.05);
        border: 1px solid #333;
        border-radius: 6px;
        color: #ccc;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: 'Space Mono', monospace;
    }
    .timeframe-btn:hover {
        border-color: #e6007a;
        color: #fff;
    }
    .timeframe-btn.active {
        background: #e6007a;
        color: #fff;
        border-color: #e6007a;
    }
`;
document.head.appendChild(style);

// –°–º–µ–Ω–∞ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
function changeTimeframe(timeframe) {
    currentTimeframe = timeframe;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    document.querySelectorAll('.timeframe-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–π–±–ª
    const timeframeLabels = {
        '1h': '1 –ß–ê–°',
        '4h': '4 –ß–ê–°–ê',
        '24h': '24 –ß–ê–°–ê',
        '7d': '7 –î–ù–ï–ô'
    };
    document.getElementById('timeframeLabel').textContent = timeframeLabels[timeframe];
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
    lastPrediction = null;
    generateStablePrediction();
}

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
async function loadRealBitcoinData() {
    try {
        console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö Bitcoin...');
        const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_24hr_high=true&include_24hr_low=true');
        
        if (!response.ok) throw new Error('API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
        
        const data = await response.json();
        const btc = data.bitcoin;
        
        console.log('–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:', btc);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
        currentPrice = btc.usd;
        document.getElementById('btcPrice').textContent = '$' + currentPrice.toLocaleString('ru-RU');
        document.getElementById('currentPriceDisplay').textContent = '$' + currentPrice.toLocaleString('ru-RU');
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
        const changeElement = document.getElementById('btcChange');
        const changeText = (btc.usd_24h_change > 0 ? '+' : '') + btc.usd_24h_change.toFixed(2) + '%';
        changeElement.textContent = changeText;
        changeElement.style.background = btc.usd_24h_change >= 0 ? 'rgba(0,255,136,0.2)' : 'rgba(255,68,68,0.2)';
        changeElement.style.color = btc.usd_24h_change >= 0 ? '#00ff88' : '#ff4444';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        document.getElementById('high24h').textContent = '$' + Math.round(btc.usd_24h_high).toLocaleString('ru-RU');
        document.getElementById('low24h').textContent = '$' + Math.round(btc.usd_24h_low).toLocaleString('ru-RU');
        document.getElementById('volume24h').textContent = '$' + (btc.usd_24h_vol / 1000000000).toFixed(1) + ' –º–ª—Ä–¥';
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        priceHistory.push({
            price: currentPrice,
            timestamp: Date.now(),
            change: btc.usd_24h_change
        });
        
        if (priceHistory.length > 100) {
            priceHistory.shift();
        }
        
        console.log('–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∞, –∑–∞–ø–∏—Å–µ–π:', priceHistory.length);
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–≥–Ω–æ–∑
        generateStablePrediction();
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
        useRealisticDemoData();
    }
}

// –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
function useRealisticDemoData() {
    console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ');
    
    // –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ Bitcoin
    const realisticPrice = 112000 + (Math.random() - 0.5) * 2000;
    
    currentPrice = realisticPrice;
    document.getElementById('btcPrice').textContent = '$' + realisticPrice.toLocaleString('ru-RU');
    document.getElementById('currentPriceDisplay').textContent = '$' + realisticPrice.toLocaleString('ru-RU');
    
    // –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
    const realisticChange = (Math.random() - 0.4) * 6;
    const changeElement = document.getElementById('btcChange');
    changeElement.textContent = (realisticChange > 0 ? '+' : '') + realisticChange.toFixed(2) + '%';
    changeElement.style.background = realisticChange >= 0 ? 'rgba(0,255,136,0.2)' : 'rgba(255,68,68,0.2)';
    changeElement.style.color = realisticChange >= 0 ? '#00ff88' : '#ff4444';
    
    // –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    document.getElementById('high24h').textContent = '$' + Math.round(realisticPrice * 1.03).toLocaleString('ru-RU');
    document.getElementById('low24h').textContent = '$' + Math.round(realisticPrice * 0.97).toLocaleString('ru-RU');
    document.getElementById('volume24h').textContent = '$' + (28 + Math.random() * 4).toFixed(1) + ' –º–ª—Ä–¥';
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
    priceHistory.push({
        price: currentPrice,
        timestamp: Date.now(),
        change: realisticChange
    });
    
    if (priceHistory.length > 100) {
        priceHistory.shift();
    }
    
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–≥–Ω–æ–∑
    generateStablePrediction();
}

// –°—Ç–∞–±–∏–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑
function generateStablePrediction() {
    console.log('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞...');
    
    // –ï—Å–ª–∏ —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –∏ –æ–Ω –Ω–µ —É—Å—Ç–∞—Ä–µ–ª (–º–µ–Ω–µ–µ 2 –º–∏–Ω—É—Ç), –Ω–µ –º–µ–Ω—è–µ–º –µ–≥–æ
    if (lastPrediction && (Date.now() - lastPrediction.timestamp < 120000)) {
        console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑');
        return;
    }
    
    // –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏, —Å–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑
    if (priceHistory.length < 3) {
        console.log('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞');
        createBasicPrediction();
        return;
    }
    
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞
    const recentPrices = priceHistory.slice(-10);
    const priceChanges = recentPrices.map(p => p.change);
    const avgChange = priceChanges.reduce((a, b) => a + b, 0) / priceChanges.length;
    
    console.log('–°—Ä–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ:', avgChange);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç—Ä–µ–Ω–¥
    let trend, signal, confidence, predictedChange;
    
    if (avgChange > 2) {
        trend = 'üìà –í–û–°–•–û–î–Ø–©–ò–ô';
        signal = '–ë–´–ß–ò–ô';
        confidence = '78%';
        predictedChange = 0.8 + (Math.random() * 0.7); // +0.8% to +1.5%
    } else if (avgChange > 0.5) {
        trend = '‚Üó –°–õ–ê–ë–´–ô –†–û–°–¢';
        signal = '–ù–ï–ô–¢–†–ê–õ–¨–ù–û-–ë–´–ß–ò–ô';
        confidence = '65%';
        predictedChange = 0.3 + (Math.random() * 0.4); // +0.3% to +0.7%
    } else if (avgChange < -2) {
        trend = 'üìâ –ù–ò–°–•–û–î–Ø–©–ò–ô';
        signal = '–ú–ï–î–í–ï–ñ–ò–ô';
        confidence = '75%';
        predictedChange = -0.8 - (Math.random() * 0.7); // -0.8% to -1.5%
    } else if (avgChange < -0.5) {
        trend = '‚Üò –°–õ–ê–ë–û–ï –ü–ê–î–ï–ù–ò–ï';
        signal = '–ù–ï–ô–¢–†–ê–õ–¨–ù–û-–ú–ï–î–í–ï–ñ–ò–ô';
        confidence = '62%';
        predictedChange = -0.3 - (Math.random() * 0.4); // -0.3% to -0.7%
    } else {
        trend = '‚ö° –ë–û–ö–û–í–û–ô';
        signal = '–ù–ï–ô–¢–†–ê–õ–¨–ù–´–ô';
        confidence = '58%';
        predictedChange = (Math.random() - 0.5) * 0.4; // -0.2% to +0.2%
    }
    
    // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
    const timeframeMultipliers = {
        '1h': 1,
        '4h': 2,
        '24h': 6,
        '7d': 15
    };
    
    predictedChange *= timeframeMultipliers[currentTimeframe];
    const predictedPrice = currentPrice * (1 + predictedChange / 100);
    
    console.log('–ü—Ä–æ–≥–Ω–æ–∑:', {
        —Ç–µ–∫—É—â–∞—è–¶–µ–Ω–∞: currentPrice,
        –∏–∑–º–µ–Ω–µ–Ω–∏–µ: predictedChange,
        –ø—Ä–æ–≥–Ω–æ–∑–¶–µ–Ω–∞: predictedPrice
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    document.getElementById('trend').textContent = trend;
    document.getElementById('signal').textContent = signal;
    document.getElementById('confidence').textContent = confidence;
    document.getElementById('volatility').textContent = Math.abs(avgChange).toFixed(1) + '%';
    
    document.getElementById('predictedPrice').textContent = '$' + Math.round(predictedPrice).toLocaleString('ru-RU');
    
    const changeElement = document.getElementById('potentialChange');
    changeElement.textContent = (predictedChange > 0 ? '+' : '') + predictedChange.toFixed(1) + '%';
    changeElement.style.color = predictedChange >= 0 ? '#00ff88' : '#ff4444';
    
    // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
    let recommendation;
    if (predictedChange > 5) {
        recommendation = 'üí™ –°–ò–õ–¨–ù–ê–Ø –ü–û–ö–£–ü–ö–ê';
    } else if (predictedChange > 1) {
        recommendation = 'üëç –ü–û–ö–£–ü–ö–ê';
    } else if (predictedChange < -5) {
        recommendation = 'üí™ –°–ò–õ–¨–ù–ê–Ø –ü–†–û–î–ê–ñ–ê';
    } else if (predictedChange < -1) {
        recommendation = 'üëé –ü–†–û–î–ê–ñ–ê';
    } else {
        recommendation = 'ü§ù –£–î–ï–†–ñ–ò–í–ê–¢–¨';
    }
    document.getElementById('recommendation').textContent = recommendation;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞
    lastPrediction = {
        timestamp: Date.now(),
        predictedPrice: predictedPrice,
        predictedChange: predictedChange
    };
    
    console.log('–ü—Ä–æ–≥–Ω–æ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω');
}

// –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö
function createBasicPrediction() {
    const predictedChange = (Math.random() - 0.5) * 4; // -2% to +2%
    const predictedPrice = currentPrice * (1 + predictedChange / 100);
    
    document.getElementById('trend').textContent = '‚ö° –ê–ù–ê–õ–ò–ó';
    document.getElementById('signal').textContent = '–ù–ï–ô–¢–†–ê–õ–¨–ù–´–ô';
    document.getElementById('confidence').textContent = '50%';
    document.getElementById('volatility').textContent = '2.0%';
    
    document.getElementById('predictedPrice').textContent = '$' + Math.round(predictedPrice).toLocaleString('ru-RU');
    
    const changeElement = document.getElementById('potentialChange');
    changeElement.textContent = (predictedChange > 0 ? '+' : '') + predictedChange.toFixed(1) + '%';
    changeElement.style.color = predictedChange >= 0 ? '#00ff88' : '#ff4444';
    
    document.getElementById('recommendation').textContent = 'ü§ù –£–î–ï–†–ñ–ò–í–ê–¢–¨';
    
    lastPrediction = {
        timestamp: Date.now(),
        predictedPrice: predictedPrice,
        predictedChange: predictedChange
    };
}

// –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
function createChart() {
    const ctx = document.getElementById('myChart').getContext('2d');
    
    // –°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
    const demoLabels = [];
    const demoData = [];
    let basePrice = 110000;
    
    for (let i = 0; i < 24; i++) {
        demoLabels.push(i + '—á');
        basePrice = basePrice * (1 + (Math.random() - 0.5) * 0.02);
        demoData.push(basePrice);
    }
    
    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: demoLabels,
            datasets: [{
                label: 'BTC/USD',
                data: demoData,
                borderColor: '#e6007a',
                backgroundColor: 'rgba(230, 0, 122, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                pointRadius: 2,
                pointBackgroundColor: '#e6007a'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                    backgroundColor: 'rgba(13, 2, 8, 0.95)',
                    borderColor: '#e6007a',
                    borderWidth: 1,
                    titleColor: '#ffffff',
                    bodyColor: '#ffffff',
                    callbacks: {
                        label: function(context) {
                            return '–¶–µ–Ω–∞: $' + context.parsed.y.toLocaleString('ru-RU');
                        }
                    }
                }
            },
            scales: {
                x: {
                    grid: {
                        color: 'rgba(255,255,255,0.1)'
                    },
                    ticks: {
                        color: '#fff'
                    }
                },
                y: {
                    grid: {
                        color: 'rgba(255,255,255,0.1)'
                    },
                    ticks: {
                        color: '#fff',
                        callback: function(value) {
                            return '$' + value.toLocaleString('ru-RU');
                        }
                    }
                }
            }
        }
    });
}

// –¢–æ—Ä–≥–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function buyBTC() {
    const price = document.getElementById('btcPrice').textContent;
    const recommendation = document.getElementById('recommendation').textContent;
    const predicted = document.getElementById('predictedPrice').textContent;
    alert(`‚úÖ –ó–ê–Ø–í–ö–ê –ù–ê –ü–û–ö–£–ü–ö–£!\n\n–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: ${price}\n–ü—Ä–æ–≥–Ω–æ–∑: ${predicted}\n–°–∏–≥–Ω–∞–ª: ${recommendation}\n\n–û—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω–µ–Ω!`);
}

function sellBTC() {
    const price = document.getElementById('btcPrice').textContent;
    const recommendation = document.getElementById('recommendation').textContent;
    const predicted = document.getElementById('predictedPrice').textContent;
    alert(`‚úÖ –ó–ê–Ø–í–ö–ê –ù–ê –ü–†–û–î–ê–ñ–£!\n\n–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: ${price}\n–ü—Ä–æ–≥–Ω–æ–∑: ${predicted}\n–°–∏–≥–Ω–∞–ª: ${recommendation}\n\n–û—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω–µ–Ω!`);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', function() {
    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞...');
    createChart();
    loadRealBitcoinData();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
    setInterval(loadRealBitcoinData, 10000);
});
</script>
{% endblock %}